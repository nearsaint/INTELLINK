(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-629f4156"],{"0ffd":function(e,t,a){},"15f9":function(e,t,a){"use strict";var n=a("f74d"),s=a.n(n);s.a},"1a33":function(e,t,a){"use strict";a.r(t);var n=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"list"},[a("h5",{directives:[{name:"show",rawName:"v-show",value:void 0==e.machine,expression:"machine==undefined"}],staticClass:"tip"},[e._v("暂无数据\n    "),a("span",[e._v("等待加载或重新刷新")])]),a("ul",e._l(e.machine.Tags,function(t,n){return a("li",{key:n,class:[1==t.RTagAlarmType||3==t.RTagAlarmType?"warrning":"",2==t.RTagAlarmType||4==t.RTagAlarmType?"alarm":""]},[a("a",{on:{click:function(a){return e.goto(e.machine.MachineId,t.TagId,t.TagName,t.TagType)}}},[0==t.DataType&&0==t.TagType?a("h3",{staticClass:"val blue"},[e._v(e._s(t.FValue)),a("span",[e._v(e._s(t.Unit))])]):e._e(),0==t.DataType&&1==t.TagType?a("h3",{staticClass:"val",class:[1==t.FValue&&0==t.AlarmType?"green":"",1==t.FValue&&1==t.AlarmType?"red":""]},[1==t.FValue&&0==t.AlarmType?[a("i",{staticClass:"iconfont"},[e._v("")])]:e._e(),1==t.FValue&&1==t.AlarmType?[a("i",{staticClass:"iconfont"},[e._v("")])]:e._e(),0==t.FValue?[a("i",{staticClass:"iconfont"},[e._v("")])]:e._e()],2):e._e(),0==t.DataType&&2==t.TagType?a("h3",{staticClass:"val blue2"},[e._v(e._s(t.FValue)),a("span",[e._v(e._s(t.Unit))])]):e._e(),1==t.DataType&&0==t.TagType?a("h3",{staticClass:"val"},[e._v('"'+e._s(t.SValue)+'"'),a("span",[e._v(e._s(t.Unit))])]):e._e(),1==t.DataType&&1==t.TagType?a("h3",{staticClass:"val"},[e._v('"'+e._s(t.SValue)+'"'),a("span",[e._v(e._s(t.Unit))])]):e._e(),a("h4",[e._v(e._s(t.TagName))]),a("i",{staticClass:"iconfont"},[e._v("")])])])}),0)])},s=[],i=a("f499"),o=a.n(i),c=a("e814"),r=a.n(c),u=a("7821"),l={data:function(){return{machineId:{},websock:null,machine:{}}},beforeCreate:function(){},created:function(){this.initWebSocket()},mounted:function(){this.get_data_query(),this.getMachine()},beforeDestroy:function(){this.websock.close()},destroyed:function(){this.websock.close()},methods:{getMachine:function(){var e=this,t=e.$store.state.iot.data.Machines;for(var a in t)e.machineId==t[a].MachineId&&(e.machine=t[a])},get_data_query:function(){this.machineId=this.$route.query.machineId,console.log(this.machineId)},routeChange:function(){this.get_data_query(),this.getMachine(),this.websocketsend()},initWebSocket:function(){var e="wss://38798879.xyz/Extension/GSocket/WSHandler.ashx";this.websock=new WebSocket(e),this.websock.onopen=this.websocketonopen,this.websock.onerror=this.websocketonerror,this.websock.onmessage=this.websocketonmessage,this.websock.onclose=this.websocketclose},websocketonopen:function(e){console.log("WebSocket连接成功"),this.websocketsend()},websocketonerror:function(e){console.log("WebSocket连接发生错误"+e)},websocketonmessage:function(e){var t=this,a=JSON.parse(e.data);if(console.log(a),a.Data.MachineStatus&&(t.machine.Status=a.Data.MachineStatus),a.Data.InitialMachineDtos){if(0==a.Data.InitialMachineDtos.length)return;t.machine.Status=a.Data.InitialMachineDtos[0].MachineStatus}var n,s=t.machine.Tags;for(var i in n=a.Data.InitialMachineDtos?a.Data.InitialMachineDtos[0].RTags:a.Data.RTags,console.log(s),console.log(n),n)for(var o in s)n[i].TagId==s[o].TagId&&(0==s[o].TagType||2==s[o].TagType?s[o].FValue=n[i].FValue.toFixed(2):s[o].FValue=n[i].FValue,s[o].SValue=n[i].SValue,s[o].RTagAlarmType=n[i].RTagAlarmType)},websocketsend:function(e){var t=this,a=r()(this.machine.MachineId),n={Key:0,Data:{MachineIds:[a]}};console.log(o()(n)),a&&setTimeout(function(){t.websock.send(o()(n),function(e){console.log(e)})},1e3)},goto:function(e,t,a,n){var s=this;0==n?s.$router.push({path:"/machine/propertys/"+e+"/property/"+t,query:{machineId:e,tagId:t,tagName:a}}):1==n&&s.$router.push({path:"/machine/propertys/"+e+"/log/"+t,query:{machineId:e,tagId:t,tagName:a}})}},computed:{},components:{chartComponent:u["a"]},watch:{$route:"routeChange"}},h=l,p=(a("15f9"),a("2877")),f=Object(p["a"])(h,n,s,!1,null,"50fb3dfc",null);t["default"]=f.exports},"5d6b":function(e,t,a){var n=a("e53d").parseInt,s=a("a1ce").trim,i=a("e692"),o=/^[-+]?0[xX]/;e.exports=8!==n(i+"08")||22!==n(i+"0x16")?function(e,t){var a=s(String(e),3);return n(a,t>>>0||(o.test(a)?16:10))}:n},7445:function(e,t,a){var n=a("63b6"),s=a("5d6b");n(n.G+n.F*(parseInt!=s),{parseInt:s})},7821:function(e,t,a){"use strict";var n=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"chart"},[a("div",{staticClass:"DBcontainer"},[a("div",{ref:"lineChart",staticClass:"chart canvas",attrs:{id:"myChart"+e.property.TagId}})]),a("div",{staticClass:"text"},[a("h4",[e._v(e._s(e.property.TagName))]),a("h4",[e._v(e._s(e.property.FValue))])])])},s=[],i={props:["query"],data:function(){return{property:{},echart:""}},beforeCreate:function(){},created:function(){this.get_data_query()},mounted:function(){this.createChart()},beforeDestroy:function(){},destroyed:function(){},methods:{get_data_query:function(){this.property=this.query,console.log(this.property)},createChart:function(){var e=this;this.echart=this.$echarts.init(document.getElementById("myChart"+e.property.TagId)),e.echart.setOption({xAxis:{boundaryGap:!1,axisLine:{show:!1},axisTick:{show:!1},axisLabel:{show:!1},splitArea:{show:!1},splitLine:{show:!1},data:[1,2,3,4]},tooltip:{trigger:"none",axisPointer:{type:"cross"}},grid:{top:0,left:0,right:0,bottom:0},yAxis:{boundaryGap:["20%","20%"],type:"value",axisLine:{show:!1},axisTick:{show:!1},axisLabel:{show:!1},splitArea:{show:!1},splitLine:{show:!1},scale:!0},series:[{data:[1,2,3,4,5],type:"line",smooth:!0,lineStyle:{color:"#fff"},itemStyle:{borderWidth:"4",borderColor:"#fff"}}]})}},computed:{},components:{}},o=i,c=(a("7b1e"),a("2877")),r=Object(c["a"])(o,n,s,!1,null,"9d78d208",null);t["a"]=r.exports},"7b1e":function(e,t,a){"use strict";var n=a("0ffd"),s=a.n(n);s.a},a1ce:function(e,t,a){var n=a("63b6"),s=a("25eb"),i=a("294c"),o=a("e692"),c="["+o+"]",r="​",u=RegExp("^"+c+c+"*"),l=RegExp(c+c+"*$"),h=function(e,t,a){var s={},c=i(function(){return!!o[e]()||r[e]()!=r}),u=s[e]=c?t(p):o[e];a&&(s[a]=u),n(n.P+n.F*c,"String",s)},p=h.trim=function(e,t){return e=String(s(e)),1&t&&(e=e.replace(u,"")),2&t&&(e=e.replace(l,"")),e};e.exports=h},b9e9:function(e,t,a){a("7445"),e.exports=a("584a").parseInt},e692:function(e,t){e.exports="\t\n\v\f\r   ᠎             　\u2028\u2029\ufeff"},e814:function(e,t,a){e.exports=a("b9e9")},f74d:function(e,t,a){}}]);